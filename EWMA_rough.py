# bid_prices = [5,4,3,2,1]
# ask_prices = [5,6,7,8,9]

# EWMA = 0.
# riskLambda = .94
# periodicReturns = []
# periodicVariance = []


# executed = (np.array(bid_prices) >= np.array(ask_prices))
# print(executed)

# # check if the best bid price exceeds the best ask price

# if(variation[0]>=0):
#     if(periodicReturns):
#         periodicReturns.append(bid_prices[0]/periodicReturns[periodicReturns.len-1])
#     else:
#         periodicReturns.append(bid_prices[0])
        
#     periodicVariance.append(np.var(periodicReturns))
    
#     print(periodicVariance)

import time
import collections # do popleft later
""" SIMPLE MOVING AVERAGE wo Order book """

day_moving_average = 10
# price_history = [854.409973, 845]
# data_to_add = [826.159973,844.549988,850.450012,844.98999,846.640015,880.799988,883.090027,864.159973,835.429993,793.530029,839.809998,872.789978,854.690002,849.98999,852.22998,863.419983,849.460022,804.820007,811.659973,816.119995,796.219971,798.150024,787.380005,781.299988,714.5,698.840027,742.02002,682.219971,675.5,718.429993,686.440002,653.200012,621.440002,597.950012,563,673.580017,668.059998]
price_history = [0.0, 0.0, 351400.0, 351450.0]
data_to_add = [351450.0, 351450.0, 351400.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351450.0, 351650.0, 351500.0, 351650.0, 351500.0, 351650.0, 351500.0, 351650.0, 351500.0, 351650.0, 351400.0, 351650.0, 351400.0, 351700.0, 351400.0, 351650.0, 351400.0, 351650.0, 351400.0, 351650.0, 351400.0, 351650.0, 351400.0, 351650.0, 351400.0, 351550.0, 351400.0, 351550.0, 351350.0, 351500.0, 351350.0, 351500.0, 351350.0, 351500.0, 351350.0, 351450.0, 351350.0, 351450.0, 351350.0, 351450.0, 351350.0, 351450.0, 351250.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351200.0, 351450.0, 351150.0, 351450.0, 351150.0, 351450.0, 351150.0, 351450.0, 351150.0, 351450.0, 351150.0, 351450.0, 351150.0, 351450.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351350.0, 351200.0, 351400.0, 351200.0, 351400.0, 351200.0, 351400.0, 351200.0, 351450.0, 351250.0, 351450.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351400.0, 351250.0, 351400.0, 351250.0, 351400.0, 351250.0, 351400.0, 351250.0, 351400.0, 351250.0, 351400.0, 351250.0, 351450.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351250.0, 351400.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351250.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351350.0, 351300.0, 351400.0, 351300.0, 351400.0, 351300.0, 351400.0, 351350.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351450.0, 351450.0, 351600.0, 351450.0, 351600.0, 351450.0, 351600.0, 351450.0, 351550.0, 351450.0, 351350.0, 351450.0, 351350.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351450.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351350.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351400.0, 351450.0, 351400.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351500.0, 351450.0, 351700.0, 351450.0, 351700.0, 351450.0, 351700.0, 351550.0, 351700.0, 351550.0, 351700.0, 351550.0, 351700.0, 351550.0, 351700.0, 351550.0, 351700.0, 351550.0, 351700.0, 351550.0]
# strategy: when price is below x day moving avg. - sell, esle buy

Done = False
while not Done:
    # finding current price
    current_price = price_history[-1]

    # Setting the moving avg
    if len(price_history) > day_moving_average:
        current_moving_avg = sum(price_history[-day_moving_average-1:]) / day_moving_average

    else:
        current_moving_avg = 0

    # printing todays data
    print(f'Price Today: ${round(current_price,2)} \n Current MA: ${round(current_moving_avg,2)}')


    # Buying or Selling logic
    if price_history[-2] < current_price and current_price >= current_moving_avg:
        print(f'BUY at {round(current_price,2)}\n')

    if price_history[-2] > current_price and current_price <= current_moving_avg:
        print(f'SELL at {round(current_price,2)}\n')

    
    print()
    # next day of simulator
    try:
        price_history.append(data_to_add.pop(0))
    except IndexError:
        break


    

    